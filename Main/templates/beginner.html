<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Beginner - 10 Topic Carousel</title>
  <style>
    :root { --green: #43a047; --green-dark: #2e7d32; }
    body { font-family: 'Gill Sans', sans-serif; background: #f5fdf5; margin:0; padding:0; text-align:center; }
    h1 { background:var(--green); color:#fff; padding:14px 0; margin:0; font-size:20px; }
    .carousel-container { position: relative; width: 90%; max-width: 960px; margin: 50px; auto ; overflow: hidden; border-radius:20px; box-shadow:0 6px 18px rgba(0,0,0,0.08); background:#fff; padding:18px; }
    .carousel { display:flex; will-change:transform; transition: transform 0.45s cubic-bezier(.22,.9,.24,1); }
    .topic-box { flex:0 0 auto; box-sizing: border-box; padding:30px; text-align:center; }
    .topic-box img { width: 25opx; height: 250px; border-radius:20px; object-fit:all; display:block; margin:0 auto 12px; box-shadow:0 6px 16px rgba(0,0,0,0.06); }
    .topic-box h2 { margin:8px 0; color:var(--green-dark); font-size:20px; }
    .topic-box p { margin:8px 0 14px; color:#444; line-height:1.3; }
    .start-btn { background:var(--green); color:#fff; border:none; border-radius:8px; padding:10px 22px; font-size:15px; cursor:pointer; transition:background .18s; }
    .start-btn:hover { background:var(--green-dark); }

    /* arrows (outside rail) */
    .arrow { position:absolute; top:50%; transform:translateY(-50%); font-size:28px; color:var(--green-dark); background:rgba(255,255,255,0.98); border:none; border-radius:50%; width:44px; height:44px; cursor:pointer; transition:background .18s, transform .12s; z-index:1000; display:flex; align-items:center; justify-content:center; box-shadow:0 6px 14px rgba(0,0,0,0.06); user-select:none; }
    .arrow:hover { background:#e6f4e6; transform:translateY(-50%) scale(1.03); }
    .arrow.left { left:10px; }
    .arrow.right { right:10px; }

    @media (max-width:600px) {
      .topic-box img { width: 160px; height:120px; }
      .arrow { width:36px; height:36px; font-size:22px; }
      h1 { font-size:18px; }
    }
  </style>
</head>
<body>
  <h1>Beginner Topics</h1>

  <div class="carousel-container" id="carouselContainer">
    <!-- IMPORTANT: the carousel rail contains ONLY the .topic-box slides -->
    <div class="carousel" id="carousel">
      <!-- 10 topic slides -->
      <div class="topic-box">
        <h2>Tree Planting</h2>
        <img src="{% static 'images\a vibrant 2D game sc.png'%}" alt="Tree Planting">
        <p>Learn how planting trees helps reduce CO₂.</p>
        <button class="start-btn" onclick="startTopic('tree-planting.html')">Start</button>
      </div>

      <div class="topic-box">
        <h2>Water Conservation</h2>
        <img src="{% static 'images\a child character in.png'%}" alt="Water Conservation">
        <p>Discover smart ways to save water at home.</p>
        <button class="start-btn" onclick="startTopic('water.html')">Start</button>
      </div>

      <div class="topic-box">
        <h2>Recycling</h2>
        <img src="{% static 'images\a child dumping plas.png'%}" alt="Recycling">
        <p>Sort, reuse, and recycle — small steps, big impact!</p>
        <button class="start-btn" onclick="startTopic('recycle.html')">Start</button>
      </div>

      

      <div class="topic-box">
        <h2>Cleaning</h2>
        <img src="{% static 'images\cleaning.png'%}"alt="Clean Energy">
        <p>Explore solar and wind energy.</p>
        <button class="start-btn" onclick="startTopic('energy.html')">Start</button>
      </div>

    

      <div class="topic-box">
        <h2>Eco Habits</h2>
        <img src="https://picsum.photos/seed/habits/600/400" alt="Eco Habits">
        <p>Simple tips to live sustainably every day.</p>
        <button class="start-btn" onclick="startTopic('habits.html')">Start</button>
      </div>
    </div>

    <!-- arrows MUST be outside the .carousel element -->
    <button class="arrow left" id="prevBtn" aria-label="Previous">&#10094;</button>
    <button class="arrow right" id="nextBtn" aria-label="Next">&#10095;</button>
  </div>

  <script>
    // Basic navigation for Start buttons
    function startTopic(page) {
      if (!page) return;
      // Replace this navigation with modal or in-app route if needed
      window.location.href = page;
    }

    (function(){
      const container = document.getElementById('carouselContainer');
      const carousel = document.getElementById('carousel');
      const slides = Array.from(carousel.querySelectorAll('.topic-box'));
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      if (!container || !carousel || slides.length === 0) return;

      let total = slides.length;
      let current = 0;

      // Set widths explicitly in pixels so translateX math is stable
      function setSizes() {
        const w = container.clientWidth;
        slides.forEach(slide => slide.style.width = `${w}px`);
        carousel.style.width = `${w * total}px`;
        // snap without animation
        carousel.style.transition = 'none';
        carousel.style.transform = `translateX(-${current * w}px)`;
        // restore transition for next moves
        requestAnimationFrame(() => { carousel.style.transition = ''; });
      }

      function goTo(index) {
        if (index < 0) index = total - 1;
        if (index >= total) index = 0;
        current = index;
        const w = container.clientWidth;
        carousel.style.transform = `translateX(-${current * w}px)`;
      }

      nextBtn.addEventListener('click', () => goTo(current + 1));
      prevBtn.addEventListener('click', () => goTo(current - 1));

      // keyboard
      window.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') prevBtn.click();
        if (e.key === 'ArrowRight') nextBtn.click();
      });

      // touch/swipe
      let startX = 0, deltaX = 0, dragging = false;
      carousel.addEventListener('touchstart', (e) => {
        if (e.touches.length !== 1) return;
        dragging = true;
        startX = e.touches[0].clientX;
        carousel.style.transition = 'none';
      }, {passive:true});

      carousel.addEventListener('touchmove', (e) => {
        if (!dragging) return;
        deltaX = e.touches[0].clientX - startX;
        const w = container.clientWidth;
        carousel.style.transform = `translateX(${-current * w + deltaX}px)`;
      }, {passive:true});

      carousel.addEventListener('touchend', () => {
        if (!dragging) return;
        dragging = false;
        const w = container.clientWidth;
        const threshold = w * 0.15;
        if (deltaX < -threshold) goTo(current + 1);
        else if (deltaX > threshold) goTo(current - 1);
        else goTo(current); // snap back
        deltaX = 0;
      });

      window.addEventListener('resize', setSizes);
      // initial
      setSizes();

      // Debug helper: if something still broken, open console and check for errors.
      // console.log('carousel ready', {total});
    })();
  </script>
</body>
</html>
